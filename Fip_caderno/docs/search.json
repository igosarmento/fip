[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Fip_caderno",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n1 + 1\n\n[1] 2\n“Este é o caderno de aulas práticas da disciplina FIP-606 – Análise e Visualização de Dados em Fitopatologia. Ele serve como material de consulta futura, com códigos para análises estatísticas, além de disponibilizar publicamente as atividades executadas em sala de aula.”"
  },
  {
    "objectID": "index.html#aula-04-diagnóstico-de-resíduos-com-dharma",
    "href": "index.html#aula-04-diagnóstico-de-resíduos-com-dharma",
    "title": "Fip_caderno",
    "section": "AULA 04 – Diagnóstico de Resíduos com DHARMa",
    "text": "AULA 04 – Diagnóstico de Resíduos com DHARMa\n\nObjetivo:\nAvaliar a qualidade do modelo ajustado m3 utilizando o pacote DHARMa, que fornece diagnósticos de resíduos simulados para modelos lineares e generalizados, testando pressupostos como normalidade e homocedasticidade.\n\nlibrary(DHARMa)\n\nThis is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n\nm3\n\n\nCall:\nlm(formula = rank(count + 0.1) ~ spray, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     52.167        2.667      -40.708      -26.583      -32.833        3.458  \n\nplot(simulateResiduals(m3))"
  },
  {
    "objectID": "index.html#aula-05-análise-de-experimentos-com-blocos-e-transformações",
    "href": "index.html#aula-05-análise-de-experimentos-com-blocos-e-transformações",
    "title": "Fip_caderno",
    "section": "AULA 05 – Análise de Experimentos com Blocos e Transformações",
    "text": "AULA 05 – Análise de Experimentos com Blocos e Transformações\n\nImportação e preparação dos dados de campo\nNeste trecho, os dados experimentais de campo são importados do Google Sheets e as variáveis categóricas são corretamente convertidas em fatores. Também convertemos a variável FER para numérica, garantindo que esteja no formato adequado para análises.\n\n\nVisualização exploratória da variável resposta\nAntes de ajustar o modelo, é fundamental visualizar a dispersão dos dados para cada tratamento e possíveis tendências nos valores de PROD (produtividade).\n\n\nAjuste de modelo linear com transformação logarítmica\nAqui, ajustamos um modelo linear para a variável FER (fermentação), transformada via logaritmo natural, considerando os efeitos fixos de bloco e tratamento.\n\n\nVerificação da significância via ANOVA\nUtilizamos a ANOVA para avaliar a significância dos efeitos de tratamento e bloco sobre a variável resposta transformada.\n\n\nDiagnóstico de resíduos do modelo\nAvaliamos os resíduos simulados do modelo com o pacote DHARMa, verificando possíveis desvios das premissas de normalidade e homocedasticidade.\n\n\nEstimativas das médias marginais (EMMeans)\nCalculamos as médias ajustadas para cada tratamento, as visualizamos e comparamos com letras de significância.\n\n\nCorrelações entre variáveis contínuas\nCalculamos correlações entre variáveis importantes do experimento (FER, PROD, DFC) para investigar relações lineares entre elas.\n\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\n\n# Importando os dados\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Convertendo variáveis em fatores corretamente\ncampo &lt;- campo |&gt; \n  mutate(TRAT = factor(TRAT),\n         BLOCO = factor(BLOCO),\n         FER = as.numeric(FER)) # Convertendo FER para numérico caso esteja como texto\n\n# Visualizando os dados\nggplot(campo, aes(x = TRAT, y = PROD)) + \n  geom_jitter(width = 0.1) + \n  stat_summary(fun.data = \"mean_cl_boot\", colour = \"red\")\n\n\n\n\n\n\n\n# Ajustando o modelo correto\nm_campo &lt;- lm(log(FER) ~ BLOCO + TRAT, data = campo)\n\n# Verificando ANOVA\nanova(m_campo)\n\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Diagnóstico de resíduos\nplot(simulateResiduals(m_campo))\n\n\n\n\n\n\n\n# Médias marginais estimadas\nmeans_campo &lt;- emmeans(m_campo, ~ TRAT, type = \"response\")\n\n# Plotando e analisando as médias\nplot(means_campo)\n\n\n\n\n\n\n\nmeans_campo\n\n TRAT response    SE df lower.CL upper.CL\n 1       20.02 1.960 21    16.33    24.54\n 2        5.68 0.556 21     4.63     6.96\n 3        3.81 0.373 21     3.11     4.67\n 4        3.08 0.301 21     2.51     3.78\n 5        3.24 0.317 21     2.64     3.97\n 6        2.98 0.292 21     2.43     3.65\n 7        3.37 0.330 21     2.75     4.13\n 8        3.48 0.341 21     2.84     4.27\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n\nlibrary(agricolae)\ncv.model(m_campo)\n\n[1] 13.13068\n\ncld(means_campo)\n\n TRAT response    SE df lower.CL upper.CL .group\n 6        2.98 0.292 21     2.43     3.65  1    \n 4        3.08 0.301 21     2.51     3.78  1    \n 5        3.24 0.317 21     2.64     3.97  1    \n 7        3.37 0.330 21     2.75     4.13  1    \n 8        3.48 0.341 21     2.84     4.27  1    \n 3        3.81 0.373 21     3.11     4.67  12   \n 2        5.68 0.556 21     4.63     6.96   2   \n 1       20.02 1.960 21    16.33    24.54    3  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 8 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\npwpp(means_campo)\n\n\n\n\n\n\n\npwpm(means_campo) # Comparação dos tratamentos numa matriz\n\n        1       2       3       4       5       6       7       8\n1 [20.02]  &lt;.0001  &lt;.0001  &lt;.0001  &lt;.0001  &lt;.0001  &lt;.0001  &lt;.0001\n2   3.525 [ 5.68]  0.1252  0.0048  0.0110  0.0028  0.0204  0.0343\n3   5.259   1.492 [ 3.81]  0.7832  0.9335  0.6440  0.9843  0.9976\n4   6.500   1.844   1.236 [ 3.08]  0.9999  1.0000  0.9976  0.9842\n5   6.178   1.753   1.175   0.951 [ 3.24]  0.9984  1.0000  0.9994\n6   6.721   1.906   1.278   1.034   1.088 [ 2.98]  0.9842  0.9431\n7   5.945   1.686   1.130   0.915   0.962   0.885 [ 3.37]  1.0000\n8   5.750   1.631   1.093   0.885   0.931   0.856   0.967 [ 3.48]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n\ncor(campo$FER, campo$PROD)\n\n[1] -0.6258321\n\ncor.test(campo$FER, campo$DFC)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo$FER and campo$DFC\nt = 14.049, df = 30, p-value = 9.864e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8635525 0.9664228\nsample estimates:\n      cor \n0.9316978 \n\ncampo |&gt; \n  ggplot(aes(FER, DFC)) +\n  geom_point() +  # Correção aqui\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "index.html#modelo-linear-misto-análise-com-dados-de-milho",
    "href": "index.html#modelo-linear-misto-análise-com-dados-de-milho",
    "title": "Fip_caderno",
    "section": "Modelo Linear Misto – Análise com Dados de Milho",
    "text": "Modelo Linear Misto – Análise com Dados de Milho\n\nImportação e visualização dos dados\nImportamos outro conjunto de dados com experimentos em milho e visualizamos os efeitos dos híbridos e métodos sobre o índice.\n\n\nPreparação dos dados e ajuste de modelo misto\nCriamos uma variável de interação entre híbrido e bloco, e ajustamos um modelo linear misto com efeito aleatório de hybrid_block.\n\n\nANOVA e diagnóstico do modelo misto\nUtilizamos a função Anova() para verificar a significância dos efeitos fixos e DHARMa para verificar resíduos simulados.\n\n\nAjuste de novo modelo para produtividade\nAjustamos um segundo modelo considerando a variável resposta yield, incorporando estrutura hierárquica com blocos aninhados em híbrido.\n\n\nAjuste de novo modelo para produtividade\nAjustamos um segundo modelo considerando a variável resposta yield, incorporando estrutura hierárquica com blocos aninhados em híbrido.\n\n\nRelação entre índice e produtividade\nExploramos a correlação entre index e yield, tanto visualmente quanto numericamente, calculando o coeficiente de determinação (R²).\n\nlibrary(gsheet)\nlibrary(lme4)\n\nCarregando pacotes exigidos: Matrix\n\n\n\nAnexando pacote: 'Matrix'\n\n\nOs seguintes objetos são mascarados por 'package:tidyr':\n\n    expand, pack, unpack\n\nlibrary(car)\n\nCarregando pacotes exigidos: carData\n\n\n\nAnexando pacote: 'car'\n\n\nO seguinte objeto é mascarado por 'package:dplyr':\n\n    recode\n\n\nO seguinte objeto é mascarado por 'package:purrr':\n\n    some\n\nlibrary(DHARMa)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(multcomp)\nlibrary(emmeans)\n\n# Importando os dados\nmilho &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualização dos dados\nmilho |&gt; \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n\n\n\n\n\n\n\n# Criando a interação de híbrido e bloco\nmilho &lt;- milho |&gt; mutate(hybrid_block = interaction(hybrid, block))\n\n# Ajuste do modelo linear misto\nm_milho &lt;- lmer(index ~ hybrid * method + (1 | hybrid_block), data = milho)\n\n# ANOVA\nAnova(m_milho)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(&gt;Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Diagnóstico de resíduos\nplot(simulateResiduals(m_milho))\n\n\n\n\n\n\n\nm_milho2 &lt;- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho2)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yield\n                Chisq Df Pr(&gt;Chisq)    \nhybrid        22.5966  5  0.0004031 ***\nmethod         0.1052  1  0.7456932    \nhybrid:method 25.9302  5  9.206e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_milho2))\n\n\n\n\n\n\n\nmedia_milho2 &lt;- emmeans(m_milho2, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n\nhybrid = 30F53 HX:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9988 798 21.1     8328    11647  a    \n pin     11208 798 21.1     9548    12867   b   \n\nhybrid = 30F53 YH:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9211 798 21.1     7552    10870  a    \n pin      9408 798 21.1     7748    11067  a    \n\nhybrid = 30K64:\n method emmean  SE   df lower.CL upper.CL .group\n silk    10361 798 21.1     8702    12020  a    \n pin     11675 798 21.1    10016    13334   b   \n\nhybrid = 30S31H:\n method emmean  SE   df lower.CL upper.CL .group\n pin      8118 798 21.1     6459     9777  a    \n silk     9185 798 21.1     7526    10844   b   \n\nhybrid = 30S31YH:\n method emmean  SE   df lower.CL upper.CL .group\n pin      7836 798 21.1     6177     9495  a    \n silk     8277 798 21.1     6618     9936  a    \n\nhybrid = BG7049H:\n method emmean  SE   df lower.CL upper.CL .group\n pin     11970 798 21.1    10311    13629  a    \n silk    12833 798 21.1    11174    14492  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Correção do erro de digitação: \"indez\" para \"index\"\nmilho |&gt; \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\ncor1 &lt;- cor(milho$index, milho$yield)\ncor1^2 * 100\n\n[1] 6.323713\n\ncor.test(milho$index, milho$yield)\n\n\n    Pearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699"
  },
  {
    "objectID": "index.html#análise-de-dose-resposta-drc-e-cálculo-de-ec50",
    "href": "index.html#análise-de-dose-resposta-drc-e-cálculo-de-ec50",
    "title": "Fip_caderno",
    "section": "Análise de Dose-Resposta (DRC) e cálculo de EC50",
    "text": "Análise de Dose-Resposta (DRC) e cálculo de EC50\nNesta seção, utilizamos o pacote drc para ajustar modelos de regressão não-linear do tipo log-logístico, que são ideais para dados de dose-resposta. Avaliamos o efeito da dose sobre a germinação fúngica, e estimamos a dose efetiva 50% (EC50) para o isolado FGT43.\nAjuste do modelo log-logístico para um isolado específico (FGT43)\n\nEstimativa de EC50 para múltiplos isolados com ec50estimator\nNeste passo, usamos um pacote específico para automatizar a estimativa de EC50 para todos os isolados presentes no conjunto de da\n\n# Importando os dados\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(drc)\n\n\n'drc' has been loaded.\n\n\nPlease cite R and 'drc' if used for a publication,\n\n\nfor references type 'citation()' and 'citation('drc')'.\n\n\n\nAnexando pacote: 'drc'\n\n\nOs seguintes objetos são mascarados por 'package:stats':\n\n    gaussian, getInitial\n\n# Gráfico com os dados\nfungi &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nfungi |&gt;\n  dplyr::group_by(code, dose) |&gt;\n  summarise(germination = mean(germination), .groups = \"drop\") |&gt;\n  ggplot(aes(dose, germination)) +\n  geom_point() +\n  facet_wrap(~ code)\n\n\n\n\n\n\n\n# Ajuste do modelo para FGT43\n\nFGT43 &lt;- fungi |&gt;\n  filter(code == \"FGT43\")\n\nm43 &lt;- drm(germination ~ dose,\n           data = FGT43,\n           fct = LL.3())\n\nplot(m43)\n\n\n\n\n\n\n\nED(m43, 50)\n\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50 0.495955   0.046022\n\nlibrary(\"ec50estimator\")\n\ndf_ec50 = estimate_EC50(germination ~dose,\n                        data = fungi,\n                        isolate_col = \"code\",\n                        strata_col = \"state\",\n                        interval = \"delta\",\n                        fct = drc:: LL.3())\ndf_ec50 |&gt;\nggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  coord_flip()\n\n\n\n\n\n\n\ndf_ec50 |&gt;\nggplot(aes(x = Estimate))+\n  geom_histogram(bins = 5, color = \"white\")\n\n\n\n\n\n\n\n\nNeste exercício, utilizaremos um conjunto de dados relacionados à ferrugem do cafeeiro (Hemileia vastatrix) na Etiópia. O objetivo é demonstrar como importar, visualizar e representar espacialmente dados fitopatológicos com ferramentas modernas de R. A base foi obtida por meio de levantamento em fazendas cafeeiras, contendo registros de latitude, longitude e incidência da doença.\nUtilizamos a função gsheet2tbl() do pacote gsheet para importar os dados diretamente da nuvem (Google Sheets). O objeto cr agora contém as observações de incidência de ferrugem do café, com coordenadas geográficas de coleta.\n\nlibrary(gsheet) \ncr &lt;-  gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1871397229#gid=1871397229\")  \n\nUsamos a função datatable() do pacote DT para gerar uma tabela interativa, facilitando a visualização e a exploração dos dados. Essa visualização é útil para verificar rapidamente colunas como lat, lon e inc.\n\nlibrary(DT) \ndatatable(cr) \n\n\n\n\n\nEssa é uma visualização básica dos pontos geográficos de coleta. A função geom_point() do ggplot2 plota cada observação com base em sua longitude (lon) e latitude (lat).\nImportamos os limites administrativos da Etiópia em formato espacial usando o pacote rnaturalearthhires. O resultado (ETH) é um objeto sf que pode ser usado com ggplot2.\nEste gráfico mostra um mapa detalhado da Etiópia com os pontos de coleta georreferenciados. A intensidade da cor representa a incidência da ferrugem do cafeeiro, permitindo identificar padrões geoespaciais da doença.\nSalva o mapa gerado no formato .png, com fundo branco e largura de 10 polegadas. Isso permite utilizar a imagem em apresentações, relatórios ou publicações.\n\nlibrary(tidyverse)\n\ncr |&gt; \n  ggplot(aes(lon, lat))+\n  geom_point()\n\n\n\n\n\n\n\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\n\nremotes:: install_github(\"ropensci/rnaturalearthhires\")\n\nDownloading GitHub repo ropensci/rnaturalearthhires@HEAD\n\n\nRunning `R CMD build`...\n\n\n* checking for file 'C:\\Users\\igo_a\\AppData\\Local\\Temp\\RtmpwvWJAB\\remotes62545f9125fd\\ropensci-rnaturalearthhires-e4736f6/DESCRIPTION' ... OK\n* preparing 'rnaturalearthhires':\n* checking DESCRIPTION meta-information ... OK\n* checking for LF line-endings in source and make files and shell scripts\n* checking for empty or unneeded directories\n* building 'rnaturalearthhires_1.0.0.9000.tar.gz'\n\n\nWarning: o pacote 'rnaturalearthhires' está em uso e não será instalado\n\nETH &lt;- ne_states(country = \"Ethiopia\", returnclass = \"sf\")\n\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(ggspatial)\n\n\nETH |&gt;\nggplot()+ \n  geom_sf(fill = \"gray80\") + \n  geom_point(data = cr, aes(lon, lat, color = inc))+\n  scale_color_viridis_c()+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  annotation_scale(location = \"tl\")+\n  annotation_north_arrow(location = \"br\", which_north = \"true\")+\n  labs(title = \"Ferrugem do café na Etiópia\", x = \"Longitude\", Y = \"Latiitude\", subtitle = \"Levantamento em fazendas\", caption = \"Fonte: Del Pnte et al. (2025)\", color = \"Incidência (%)\")\n\n\n\n\n\n\n\nggsave(\"mapa_etiopia.png\", bg = \"white\", width = 10)\n\nSaving 10 x 5 in image"
  }
]