{"title":"Fip_caderno","markdown":{"yaml":{"title":"Fip_caderno"},"headingText":"üìò **Aula 1 ‚Äî Importa√ß√£o, Manipula√ß√£o e Visualiza√ß√£o de Dados no R**","containsRefs":false,"markdown":"\n\nThis is a Quarto website.\n\nTo learn more about Quarto websites visit <https://quarto.org/docs/websites>.\n\n```{r}\n1 + 1\n```\n\n\"Este √© o caderno de aulas pr√°ticas da disciplina FIP-606 ‚Äì An√°lise e Visualiza√ß√£o de Dados em Fitopatologia. Ele serve como material de consulta futura, com c√≥digos para an√°lises estat√≠sticas, al√©m de disponibilizar publicamente as atividades executadas em sala de aula.\"\n\n\nVamos importar um conjunto de dados que est√° dispon√≠vel no R.\n\nNeste trecho, est√° sendo utilizado o dataset `Orange`, que j√° vem embutido no R. Ele cont√©m medidas de crescimento (circunfer√™ncia) de laranjeiras ao longo do tempo. A vari√°vel `dados` armazena esse conjunto para uso posterior.\n\n```{r}\ndados <- Orange\nOrange\n```\n\n**Transforma√ß√µes de dados**\n\nAqui √© feita a extra√ß√£o da vari√°vel `circumference`, e s√£o aplicadas transforma√ß√µes matem√°ticas comuns em an√°lise de dados:\n\n-   `exp(circ)` calcula o valor exponencial da circunfer√™ncia;\n\n-   `log(circ2)` retorna o logaritmo dos valores transformados.\\\n    Essas transforma√ß√µes s√£o √∫teis para explorar a distribui√ß√£o dos dados ou atender premissas de normalidade e homogeneidade de vari√¢ncia em an√°lises estat√≠sticas.\n\n```{r}\ncirc<-dados$circumference\ncirc2<-exp(circ)\ncirc2\ncirc3=log(circ2)\n```\n\n# Adi√ß√£o de uma variavel nova nos dados originais:\n\nNeste bloco, √© criada e adicionada ao dataframe original a nova vari√°vel `logcirc`, que representa o logaritmo da circunfer√™ncia. Isso facilita an√°lises futuras, como modelos lineares, que podem se beneficiar de vari√°veis transformadas.\n\n```{r}\ndados\ndados$logcirc<-log(dados$circumference)\ndados\n```\n\n# Desagregar um conjunto de dados em variaveis independentes:\n\nCom `attach()`, as vari√°veis do dataframe `dados` passam a estar dispon√≠veis diretamente no ambiente do R, sem a necessidade de usar `$`.\n\n```{r}\nattach(dados)\ncircumference\n```\n\n**Instala√ß√£o e uso de pacotes; c√°lculo de AUDPC**\n\nAqui s√£o carregados os pacotes `agricolae` (para an√°lises agr√≠colas) e `tidyverse` (conjunto de pacotes para ci√™ncia de dados). Em seguida, s√£o definidos vetores com dias e severidade da doen√ßa. A fun√ß√£o `audpc()` calcula a √Årea Abaixo da Curva de Progresso da Doen√ßa (AUDPC), uma m√©trica para quantificar a progress√£o temporal de doen√ßas em plantas.\n\n**Acessando dados do pacote agricolae**\n\nEste bloco carrega e inspeciona o dataset `corn`, tamb√©m do pacote `agricolae`. A fun√ß√£o `str()` √© usada para visualizar a estrutura do conjunto de dados, incluindo tipos de vari√°veis e primeiras observa√ß√µes ‚Äî etapa essencial na explora√ß√£o inicial dos dados.\n\n```{r}\nlibrary(agricolae)\nlibrary(tidyverse)\ndates <- c(14,21,28) # days\nseverity <- c(40,80,90)\nseverity\naudpc(severity,dates)\n\ndata(corn)\ncorn\nstr(corn)\n```\n\n### Criando gr√°ficos simples com `ggplot2`\n\nUm novo dataframe (`data_curva`) √© criado para representar a evolu√ß√£o da severidade ao longo do tempo. Em seguida, √© feito um gr√°fico combinando colunas (`geom_col`), linha (`geom_line`) e pontos (`geom_point`). Essa abordagem facilita a visualiza√ß√£o de tend√™ncias e flutua√ß√µes temporais de doen√ßas.\n\n```{r}\n\nlibrary(tidyverse)\ndates <- c(7,14,21,28,35,42) # days\nseverity <- c(0.1,5,10,35,50,60)\ndata_curva<-data.frame(dates,severity)\ndata_curva\n# meu primeiro plot\ndata_curva |>\n  mutate(severity2 = c(1,10,35,58,70,82)) |> \n  ggplot(aes(dates,severity2))+\n  geom_col()+\n  geom_line(linewidth = 2,color=\"blue\")+\n  geom_point(size = 5)+\n  theme_classic(base_size = 14)+\n  labs(x=\"Dia ap√≥s o plantio\",\n       y=\"severidade(%)\")+\n  scale_y_continuous(limits = c(0,100),n.breaks = 10)+\n  scale_x_continuous(n.breaks = 8)\n```\n\n### **Personalizando cores do gr√°fico**\n\nEste gr√°fico repete a visualiza√ß√£o anterior, mas com personaliza√ß√£o de **cores**: barras pretas, linha roxa e pontos pretos. Isso demonstra como `ggplot2` permite criar visualiza√ß√µes estilizadas para apresenta√ß√£o de resultados em artigos, relat√≥rios e slides.\n\n```{r}\ndata_curva |> \n  mutate(severity2 = c(1,10,35,58,70,82)) |> \n  ggplot(aes(dates, severity2)) +\n  geom_col(fill = \"BLACK\") +  # Barras em roxo\n  geom_line(linewidth = 2, color = \"PURPLE\") +  # Linha em roxo\n  geom_point(size = 5, color = \"black\") +  # Pontos em roxo\n  theme_classic(base_size = 14) +\n  labs(x = \"Dia ap√≥s o plantio\",\n       y = \"severidade(%)\") +\n  scale_y_continuous(limits = c(0, 100), n.breaks = 10) +\n  scale_x_continuous(n.breaks = 8)\n\n```\n\n# üìò **Aula 2 ‚Äî Leitura de Dados e Visualiza√ß√£o com `ggplot2`**\n\nO pacote `tidyverse` √© carregado para garantir acesso a fun√ß√µes essenciais para manipula√ß√£o de dados (`dplyr`, `readr`, `ggplot2`, etc.). Isso √© uma boa pr√°tica em qualquer an√°lise moderna no R.\n\n```{r}\nlibrary(tidyverse)\n```\n\n# Carregamento e leitura de arquivos Excel com `readxl`\n\nAqui o pacote `readxl` √© usado para importar uma planilha Excel (`.xlsx`) localizada localmente no computador. A aba (sheet) chamada `\"sensibilidade_fungicidas\"` √© lida e armazenada no objeto `dados`.\n\n```{r}\nlibrary(readxl)\nlibrary(tidyverse)\ndados <- read_excel(\"dados.xlsx\", sheet = \"sensibilidade_fungicidas\")\ndados \n\n```\n\n**Inspe√ß√£o da estrutura dos dados**\n\nAs fun√ß√µes `str()` e `glimpse()` ajudam a visualizar rapidamente as vari√°veis, tipos de dados e primeiras entradas. Isso √© crucial para entender como manipular ou transformar os dados corretamente.\n\n```{r}\nstr (dados)\n```\n\n```{r}\nglimpse(dados)\n```\n\n**Lendo diferentes abas do mesmo arquivo Excel**\n\nTesta-se a leitura de outras abas com nomes diferentes (`\"sensibilidade-fungicida\"` e `\"Planilha1\"`). Isso √© √∫til quando o mesmo arquivo cont√©m v√°rias tabelas experimentais.\n\n```{r}\ndados2 <- read_excel(\"dados.xlsx\",\n                  sheet = \"sensibilidade-fungicida\")\n```\n\n```{r}\nstr(dados2)\n```\n\n```{r}\nglimpse(dados2)\n```\n\n```{r}\ndados2 <- read_excel(\"dados.xlsx\",\n                  sheet = \"Planilha1\")\n\ndados2\n```\n\n# Importando dados do Google Sheets com `gsheet`\n\nCom o pacote `gsheet`, √© poss√≠vel importar dados diretamente do Google Sheets usando a fun√ß√£o `gsheet2tbl()`. Isso facilita o trabalho colaborativo e elimina a necessidade de downloads manuais.\n\n**Contagens e agrupamentos simples com `dplyr`**\n\nS√£o feitas contagens de observa√ß√µes agrupadas por `species`, `residue` e tamb√©m a combina√ß√£o entre `state` e `residue`. Essas an√°lises descritivas ajudam a entender a distribui√ß√£o dos dados.\n\n**Filtrando e combinando subconjuntos**\n\nAqui s√£o extra√≠das observa√ß√µes espec√≠ficas de dois estados (RS e PR) e unidas com `rbind()`. Isso permite compara√ß√µes regionais em an√°lises posteriores.\n\n**Selecionando colunas e criando subconjuntos anuais**\n\nS√£o criados subconjuntos contendo apenas informa√ß√µes relevantes e filtrados por ano, permitindo an√°lises temporais.\n\n**Selecionando colunas e criando subconjuntos anuais**\n\n`tabyl()` do pacote `janitor` produz tabelas cruzadas simples e organizadas, √∫teis para relat√≥rios e an√°lises explorat√≥rias.\n\n```{r}\n\nlibrary(gsheet)\ndados_nuvem <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\ndados_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\ndados_survey <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1118819738#gid=1118819738\")\n\nlibrary(dplyr)\ndados_survey |>\n  group_by(species) |>\n  count()\n\ndados_survey |>\n  group_by(residue) |>\n  count()\n\ndados_survey |>\n  group_by(state, residue) |>\n  count()\n\nRS <- dados_survey |>\n  filter(state== \"RS\")\n\nPR <- dados_survey |>\n  filter(state== \"PR\")\n\ncombinado <- rbind(RS, PR)\n\n\nsurvey_b <- dados_survey |>\n  dplyr:: select(year, state, species)\n\nsurvey_2009 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2009)\n\nsurvey_2010 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2010)\n\nsurvey_2011 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2011)\n\nlibrary(janitor)\nsurvey_b |>\n  tabyl(state, species)\n\nlibrary(janitor)\nsurvey_b |>\n  tabyl(species, year)\n\nlibrary(ggplot2)\n\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species))+\n  geom_col()+\n  scale_fill_manual(values=c(\"Purple\",\"yellow\"))\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species))+\n  geom_col()+\n  scale_fill_grey()\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species, color= species))+\n  geom_col()+\n  scale_fill_viridis_d()\n\n\n```\n\n**Gr√°ficos de barras com `ggplot2`**\n\nNeste gr√°fico de barras agrupadas, visualiza-se a frequ√™ncia de esp√©cies por ano. A paleta de cores √© personalizada. S√£o mostradas v√°rias varia√ß√µes desse gr√°fico:\n\n-   `scale_fill_manual()` ‚Äî cores definidas manualmente;\n\n-   `scale_fill_grey()` ‚Äî escala de cinza;\n\n-   `scale_fill_viridis_d()` ‚Äî cores perceptualmente uniformes, boas para dalt√¥nicos.\n\n**Boxplot com dados de magn√©sio**\n\nEste gr√°fico compara o efeito de diferentes tratamentos com magn√©sio sobre o comprimento da les√£o. O uso de `geom_jitter()` evita sobreposi√ß√£o dos pontos, melhorando a visualiza√ß√£o.\n\n```{r}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggplot2)\nlibrary(ggthemes)\nplot_magnesio <- mg |>\n  ggplot(aes(trat, comp))+\n  geom_boxplot(fill = \"white\",\n               outlier.colour = NA)+\n  geom_jitter(width = 0.1)+\n  scale_y_continuous(limits = c(0,20) )+\n  labs(x= \"Tratamento\",\n       y= \"Comprimento (mm)\",\n       title = \"Efeito do magn√©sio\",\n       subtitle = \"Tamanho da les√£o de mancha\",\n       caption = \"Fonte (SILVA, I. S. et al. 2025\")+\n  theme_clean()\nplot_magnesio\n```\n\n**Boxplot para taxa de crescimento micelial**\n\nOutro boxplot, agora para taxa de crescimento micelial por esp√©cie. As categorias s√£o reordenadas com `reorder()`, e o gr√°fico √© rotacionado (`coord_flip()`) para facilitar a leitura.\n\n```{r}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nlibrary(ggplot2)\nlibrary(ggthemes) # Para usar o tema theme_clean()\n\nplot_micelial <- micelial |> \n  ggplot(aes(x = reorder(especie, tcm), y = tcm)) +\n  geom_boxplot(fill = \"white\", outlier.colour = NA) +\n  geom_jitter(width = 0.1) +\n  coord_flip() +\n  labs(\n    x = \"Esp√©cie\",\n    y = \"TCM (mm)\",\n    title = \"Taxa de crescimento micelial\",\n    caption = \"Fonte: SILVA, I. S. et al. 2025\"\n  ) +\n  theme_clean()\nplot_micelial\n```\n\n**Combinando m√∫ltiplos gr√°ficos com `patchwork`**\n\nUtiliza-se o pacote `patchwork` para combinar os dois gr√°ficos anteriores lado a lado com anota√ß√µes (A, B, ...). O resultado √© salvo como imagem (`Combo1.png`), ideal para uso em relat√≥rios e artigos.\n\n```{r}\nlibrary(patchwork)\n(plot_magnesio|plot_micelial)+\n  plot_annotation(tag_levels = \"A\")\nggsave(\"Combo1.png\", bg = \"white\",\n       width = 8, height = 4)\n```\n\n# Aula 03 ‚Äî Testes estat√≠sticos (t, ANOVA, Kruskal), visualiza√ß√£o e checagem de pressupostos\n\n**Carregando e visualizando os dados do efeito do magn√©sio**\n\nNeste trecho, utilizamos pacotes essenciais (`gsheet`, `ggplot2` e `tidyr`) para importar dados diretamente de uma planilha do Google Sheets. Os dados cont√™m medi√ß√µes de comprimento de les√£o sob diferentes tratamentos. Em seguida, fazemos uma visualiza√ß√£o preliminar por meio de um gr√°fico de dispers√£o para comparar os tratamentos.\n\n### **Explorando os dados e realizando teste t para duas amostras independentes**\n\nAqui visualizamos as vari√°veis do objeto `dat_mg2`, convertemos o formato dos dados para wide, e comparamos os tratamentos \"control\" e \"Mg2\" por meio de um **teste t para amostras independentes**. Isso permite avaliar se h√° diferen√ßa significativa entre os dois grupos.\n\n### **Alternativa ao teste t com f√≥rmula e visualiza√ß√£o dos resultados**\n\nAgora utilizamos a f√≥rmula `comp ~ trat` dentro do teste t, com dados no formato longo. Tamb√©m utilizamos o pacote `ggpubr` para gerar um gr√°fico boxplot com anota√ß√£o do valor de **p**, facilitando a interpreta√ß√£o visual da compara√ß√£o estat√≠stica.\n\n### **Testes de normalidade e homogeneidade de vari√¢ncia**\n\nEsses testes s√£o premissas importantes para aplicar o teste t. O **teste de Shapiro-Wilk** avalia a normalidade dos dados, enquanto o **teste F de vari√¢ncias (var.test)** verifica a homogeneidade das vari√¢ncias entre os grupos.\n\n```{r}\n\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyr)\n\n\ndat_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\ndat_mg |> \n  ggplot2::ggplot(aes(trat, comp)) +\n  ggplot2::geom_jitter(width = 0.1)\n\nlibrary(dplyr)\n\ndat_mg2 <- dat_mg |> \n  pivot_wider(names_from = \"trat\", values_from = \"comp\") |>\n  dplyr:: select(-rep)\n\nnames(dat_mg2)\nglimpse(dat_mg2)\nhead(dat_mg2)\n\n\n\nattach(dat_mg2)\nt.test(control, Mg2,\n       var.equal = FALSE)\nt_results <- t.test(control, Mg2)\n\nlibrary(report)\nreport(t_results)\n\n\nlibrary(rstatix)\n\ntest <- t.test(comp ~ trat, data = dat_mg)\n\n # Instala o pacote\nlibrary(ggpubr)            # Carrega o pacote\n\n# Gr√°fico boxplot com ggboxplot\n\nlibrary(ggpubr)\n\nprint(test)\n\n# Crie o data frame com a compara√ß√£o e o valor de p\n\nlibrary(ggpubr)\n\nlibrary(ggpubr)\n\n# Crie o data frame com a compara√ß√£o e o valor de p\ntest <- data.frame(\n  group1 = \"control\",\n  group2 = \"Mg2\",\n  p.value = 2.423e-07,\n  y.position = 18\n)\n\np <- ggboxplot(dat_mg,\n               x = \"trat\",\n               y = \"comp\",\n               color = \"trat\",\n               palette = \"jco\")\np + stat_pvalue_manual(test, label = \"p.value\") +\n  ylim(0, 20)\n\n#Teste normalidade dos dados\n\nshapiro.test(dat_mg2$Mg2)\nshapiro.test(dat_mg2$control)\nhist(dat_mg2$Mg2, main = \"Histograma de Mg2\", xlab = \"Valores de comp\")\nhist(dat_mg2$control, main = \"Histograma de Controle\", xlab = \"Valores de comp\")\nvar.test(dat_mg2$Mg2, dat_mg2$control)\n\n# Homogenidade das variancias e normalidade sao as premissas do test T\n\n# Teste para saber se as variancias s√£o homogeneas - teste F\n\n# F = 1.4781, num df = 9, denom df = 9, p-value = 0.5698 - N√£o rejeita a hipotese nula, ent√£o as variancias sao homogeas \n\n# O test T ainda pode ser utilizado quando as variancias n√£o sao homogeas.\n\n\n```\n\n### **Teste t para amostras pareadas (dependentes)**\n\nEste conjunto de dados representa avalia√ß√µes feitas pelos mesmos avaliadores antes e depois de uma interven√ß√£o. Por isso, o teste t pareado √© apropriado. Utilizamos tamb√©m `pivot_wider` para estruturar os dados corretamente.\n\n### **Visualiza√ß√£o e testes de normalidade e vari√¢ncia (caso pareado)**\n\nAqui comparamos os grupos graficamente e testamos normalidade e homogeneidade das vari√¢ncias antes de aplicar os testes t e Wilcoxon (param√©trico e n√£o-param√©trico, respectivamente).\n\n```{r}\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(tidyr)\n\nescala  <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\n\n\nescala_wider <- escala %>%\n  pivot_wider(id_cols = rater, names_from = assessment, values_from = acuracia)\n\nnames(escala_wider)\n\nt.test(escala_wider$Unaided, escala_wider$Aided1,\n       paired = TRUE,\n       var.equal = FALSE)\n\nescala |>\n  ggplot(aes(x = assessment, y = acuracia)) +\n  geom_boxplot() +\n  labs(title = \"Compara√ß√£o da Acur√°cia por Assessment\",\n       x = \"Assessment\",\n       y = \"Acur√°cia\")\n\n\n# Filtrar e extrair a acur√°cia para os grupos\nunaided <- escala %>%\n  filter(assessment == \"Unaided\") %>%\n  dplyr:: select(acuracia) %>%\n  pull()\n\naided <- escala %>%\n  filter(assessment == \"Aided1\") %>% # Assumindo que o outro grupo √© \"Aided1\"\n  dplyr:: select(acuracia) %>%\n  pull()\n\n# Teste de compara√ß√£o de vari√¢ncias\nvar.test(unaided, aided)\n\n# Histogramas\nhist(unaided, main = NULL, xlab = NULL, ylab = NULL)\nhist(aided, main = NULL, xlab = NULL, ylab = NULL)\n\n# Testes de normalidade de Shapiro-Wilk\nshapiro.test(unaided)\nshapiro.test(aided)\n\n\n# Teste t N√ÉO pareado (Welch, assumindo vari√¢ncias possivelmente desiguais)\nt.test(unaided, aided, paired = FALSE, var.equal = FALSE)\n\n# Teste de Wilcoxon N√ÉO pareado\nwilcox.test(unaided, aided, paired = FALSE)\n```\n\n**ANOVA: compara√ß√£o entre mais de dois grupos**\n\nUsamos um conjunto de dados sobre o crescimento micelial para aplicar **ANOVA**, verificar pressupostos (normalidade e homogeneidade de vari√¢ncia), e seguir com compara√ß√µes m√∫ltiplas usando `emmeans`.\n\n```{r}\n\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(ggplot2) # \nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nmicelial %>%\n  ggplot(aes(x = especie, y = tcm)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1)\n\n    \nanova1 <- aov(tcm ~ especie, data = micelial)\nanova2 <- lm(tcm ~ especie, data = micelial)\n \nanova(anova1)\nanova(anova2)\nhist(residuals(anova1))\nshapiro.test(residuals(anova1))\n\n# Rejeita hipotese nula p- valor 2.028e-07.\n\n# Shapiro test =  p-value = 0.8782 n√£o rejeita.\n\nbartlett.test(tcm ~ especie, data = micelial)\nlibrary(rstatix)\nlevene_test(tcm ~ especie, data = micelial)\n\n\n# Para esse conjunto de dados, tem duas premissas legais.\n\nlibrary(emmeans)\n\nm = emmeans(anova2, ~ especie)\nm\n\nlibrary(multcomp)\ncld(m)\npairs(m) # Ao inves da matriz, faz uma tabela\npwpm(m) # Medias (comparando matriz)\n\n```\n\n### **Transforma√ß√µes, ANOVA e testes n√£o-param√©tricos**\n\nCom o conjunto `InsectSprays`, comparamos a efic√°cia de diferentes inseticidas por ANOVA. Aplicamos transforma√ß√µes para normalizar os dados e, alternativamente, usamos **Kruskal-Wallis**, que √© um teste n√£o-param√©trico para mais de dois grupos.\n\n```{r}\n# Novo conjundo de dados\n\nlibrary(ggplot2)\nlibrary(rstatix)\ninsetos = InsectSprays # Comparar insetiscidas diferentes\n\ninsetos |>\n  ggplot(aes(x = spray, y = count)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1)\nbartlett.test(count ~ spray, data = insetos)\n\nm2 <- lm(count ~ spray, data = insetos)\nhist(residuals(m2))\nshapiro_test(residuals(m2))\nqqnorm(residuals(m2))\nqqline(residuals(m2))\n\n## Alternativa 1 - transformar a resposta\n\n\nlibrary(rstatix) # Para shapiro_test\nlibrary(report)   # Para a fun√ß√£o report\n\nm3 <- lm(rank(count + 0.1) ~ spray, data = insetos)\nhist(residuals(m3), main = \"Histograma dos Res√≠duos\", xlab = \"Res√≠duos\")\nshapiro_test(residuals(m3))\nqqnorm(residuals(m3))\nqqline(residuals(m3))\nanova(m3)\n\n\nm33 <- emmeans(m3, ~ spray, type = \"response\")\ncld(m33)\nplot(m33)\n\n\n# Fazer o lm sem tranformar ***\n\n# Alternativa 2 - n√£o parametrico #\n\n# O teste n√£o-param√©trico equivalente √† ANOVA √© o Teste de Kruskal-Wallis.\n\nkruskal.test(count ~ spray, data = insetos)\nkruskal_test(insetos, count ~ spray)\n\nlibrary(agricolae)\nkruskal(insetos$count, insetos$spray, group = TRUE,\n        console = TRUE)\n```\n\n## **AULA 04 ‚Äì Diagn√≥stico de Res√≠duos com DHARMa**\n\n### **Objetivo:**\n\nAvaliar a qualidade do modelo ajustado `m3` utilizando o pacote **DHARMa**, que fornece diagn√≥sticos de res√≠duos simulados para modelos lineares e generalizados, testando pressupostos como normalidade e homocedasticidade.\n\n```{r}\n\nlibrary(DHARMa)\nm3\nplot(simulateResiduals(m3))\n\n\n\n\n```\n\n## **AULA 05 ‚Äì An√°lise de Experimentos com Blocos e Transforma√ß√µes**\n\n### **Importa√ß√£o e prepara√ß√£o dos dados de campo**\n\nNeste trecho, os dados experimentais de campo s√£o importados do Google Sheets e as vari√°veis categ√≥ricas s√£o corretamente convertidas em fatores. Tamb√©m convertemos a vari√°vel `FER` para num√©rica, garantindo que esteja no formato adequado para an√°lises.\n\n### **Visualiza√ß√£o explorat√≥ria da vari√°vel resposta**\n\nAntes de ajustar o modelo, √© fundamental visualizar a dispers√£o dos dados para cada tratamento e poss√≠veis tend√™ncias nos valores de `PROD` (produtividade).\n\n### **Ajuste de modelo linear com transforma√ß√£o logar√≠tmica**\n\nAqui, ajustamos um modelo linear para a vari√°vel `FER` (fermenta√ß√£o), transformada via logaritmo natural, considerando os efeitos fixos de bloco e tratamento.\n\n### **Verifica√ß√£o da signific√¢ncia via ANOVA**\n\nUtilizamos a ANOVA para avaliar a signific√¢ncia dos efeitos de tratamento e bloco sobre a vari√°vel resposta transformada.\n\n### **Diagn√≥stico de res√≠duos do modelo**\n\nAvaliamos os res√≠duos simulados do modelo com o pacote **DHARMa**, verificando poss√≠veis desvios das premissas de normalidade e homocedasticidade.\n\n### **Estimativas das m√©dias marginais (EMMeans)**\n\nCalculamos as m√©dias ajustadas para cada tratamento, as visualizamos e comparamos com letras de signific√¢ncia.\n\n### **Correla√ß√µes entre vari√°veis cont√≠nuas**\n\nCalculamos correla√ß√µes entre vari√°veis importantes do experimento (`FER`, `PROD`, `DFC`) para investigar rela√ß√µes lineares entre elas.\n\n```{r}\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\n\n# Importando os dados\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Convertendo vari√°veis em fatores corretamente\ncampo <- campo |> \n  mutate(TRAT = factor(TRAT),\n         BLOCO = factor(BLOCO),\n         FER = as.numeric(FER)) # Convertendo FER para num√©rico caso esteja como texto\n\n# Visualizando os dados\nggplot(campo, aes(x = TRAT, y = PROD)) + \n  geom_jitter(width = 0.1) + \n  stat_summary(fun.data = \"mean_cl_boot\", colour = \"red\")\n\n# Ajustando o modelo correto\nm_campo <- lm(log(FER) ~ BLOCO + TRAT, data = campo)\n\n# Verificando ANOVA\nanova(m_campo)\n\n# Diagn√≥stico de res√≠duos\nplot(simulateResiduals(m_campo))\n\n# M√©dias marginais estimadas\nmeans_campo <- emmeans(m_campo, ~ TRAT, type = \"response\")\n\n# Plotando e analisando as m√©dias\nplot(means_campo)\nmeans_campo\nlibrary(agricolae)\ncv.model(m_campo)\ncld(means_campo)\npwpp(means_campo)\npwpm(means_campo) # Compara√ß√£o dos tratamentos numa matriz\n\ncor(campo$FER, campo$PROD)\ncor.test(campo$FER, campo$DFC)\n\ncampo |> \n  ggplot(aes(FER, DFC)) +\n  geom_point() +  # Corre√ß√£o aqui\n  geom_smooth(method = \"lm\")\n\n\n```\n\n## **Modelo Linear Misto ‚Äì An√°lise com Dados de Milho**\n\n### **Importa√ß√£o e visualiza√ß√£o dos dados**\n\nImportamos outro conjunto de dados com experimentos em milho e visualizamos os efeitos dos h√≠bridos e m√©todos sobre o √≠ndice.\n\n### **Prepara√ß√£o dos dados e ajuste de modelo misto**\n\nCriamos uma vari√°vel de intera√ß√£o entre h√≠brido e bloco, e ajustamos um modelo linear misto com efeito aleat√≥rio de `hybrid_block`.\n\n### **ANOVA e diagn√≥stico do modelo misto**\n\nUtilizamos a fun√ß√£o `Anova()` para verificar a signific√¢ncia dos efeitos fixos e `DHARMa` para verificar res√≠duos simulados.\n\n### **Ajuste de novo modelo para produtividade**\n\nAjustamos um segundo modelo considerando a vari√°vel resposta `yield`, incorporando estrutura hier√°rquica com blocos aninhados em h√≠brido.\n\n### **Ajuste de novo modelo para produtividade**\n\nAjustamos um segundo modelo considerando a vari√°vel resposta `yield`, incorporando estrutura hier√°rquica com blocos aninhados em h√≠brido.\n\n### **Rela√ß√£o entre √≠ndice e produtividade**\n\nExploramos a correla√ß√£o entre `index` e `yield`, tanto visualmente quanto numericamente, calculando o coeficiente de determina√ß√£o (R¬≤).\n\n```{r}\n\nlibrary(gsheet)\nlibrary(lme4)\nlibrary(car)\nlibrary(DHARMa)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(multcomp)\nlibrary(emmeans)\n\n# Importando os dados\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualiza√ß√£o dos dados\nmilho |> \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n\n# Criando a intera√ß√£o de h√≠brido e bloco\nmilho <- milho |> mutate(hybrid_block = interaction(hybrid, block))\n\n# Ajuste do modelo linear misto\nm_milho <- lmer(index ~ hybrid * method + (1 | hybrid_block), data = milho)\n\n# ANOVA\nAnova(m_milho)\n\n# Diagn√≥stico de res√≠duos\nplot(simulateResiduals(m_milho))\n\nm_milho2 <- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho2)\nplot(simulateResiduals(m_milho2))\n\nmedia_milho2 <- emmeans(m_milho2, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n\n# Corre√ß√£o do erro de digita√ß√£o: \"indez\" para \"index\"\nmilho |> \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n\ncor1 <- cor(milho$index, milho$yield)\ncor1^2 * 100\ncor.test(milho$index, milho$yield)\n\n\n\n```\n\n# AULA 06 ‚Äì Transforma√ß√µes Box-Cox, Regress√£o e Modelos Mistos\n\n### **Transforma√ß√£o Box-Cox em dados com problemas de normalidade**\n\nA transforma√ß√£o de Box-Cox √© √∫til quando os dados n√£o atendem aos pressupostos de normalidade e homocedasticidade. O m√©todo busca encontrar uma pot√™ncia (lambda) ideal para transformar a vari√°vel resposta e melhorar o ajuste do modelo linear. Aqui, usamos dados do conjunto `InsectSprays` e aplicamos a transforma√ß√£o em `count`.\n\n```{r}\n\nlibrary(MASS)\nlibrary(DHARMa)\nlibrary(tidyverse)\nlibrary(agricolae)\n\ninsects <- InsectSprays\nm1 <- lm(sqrt(count) ~ spray, data = insects)\nplot(m1)\n\nb <- boxcox(lm(count + 0.1 ~ 1, data = insects))\nlambda <- b$x[which.max(b$y)]\nlambda\n\ninsects <- insects |>\n  mutate(count2 = (count^lambda - 1) / lambda,\n         count3 = sqrt(count))\n\nhist(insects$count)\n\nm1 <- lm(count2 ~ spray, data = insects)\nplot(m1)\n\n# Usar quando as premissas dos dados usando log e raiz quadrada nao est√£o ok\n\n\n\n\n```\n\n> **Nota:** A transforma√ß√£o Box-Cox √© especialmente √∫til quando transforma√ß√µes usuais como log ou raiz quadrada n√£o resolvem os problemas dos res√≠duos do modelo.\n\n### **An√°lise de regress√£o simples por experimento**\n\nNesta se√ß√£o, usamos dados experimentais sobre a porcentagem de in√≥culo e o n√∫mero de plantas infectadas. Inicialmente, visualizamos os dados e depois realizamos uma regress√£o linear simples para cada experimento individualmente (exp1, exp2 e exp3).\n\n```{r}\n# Importando os dados\n\nlibrary(gsheet)\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555\")\n\n# Ser√° que tem efeito a concentra√ß√£o de inoculo no n√∫mero de plantas infectadas?\n\n\nlibrary(ggplot2)\n\nestande |>\nggplot(aes(x = trat, y = nplants)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",  se = FALSE,\n              color = \"black\")+\n  facet_wrap( ~exp)+\n  theme_minimal()+\n  labs(x = \" % de inoculo na semente\",\n       y = \"N√∫mero de Plantas\")\n```\n\n# Regress√µes individuais por experimento\n\n```{r}\nexp1 <- estande |>\n  filter(exp == 1)\n\nm_exp1 <- lm(nplants ~ trat, data = exp1)\nsummary(m_exp1)\n\nexp1 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n    ylim(20,60)\n\nexp2 <- estande |>\n  filter(exp == 2)\n\nm_exp2 <- lm(nplants ~ trat, data = exp2)\nsummary(m_exp2)\n\nexp3 <- estande |>\n  filter(exp == 3)\n\nm_exp3 <- lm(nplants ~ trat, data = exp3)\nsummary(m_exp3)\n```\n\n### **Modelo linear misto para considerar estrutura hier√°rquica**\n\nCom dados oriundos de m√∫ltiplos experimentos com blocos, um **modelo misto** √© mais apropriado para considerar a varia√ß√£o entre blocos dentro de cada experimento. Isso permite generalizar os resultados sem ignorar fontes de varia√ß√£o.\n\n```{r}\nlibrary(lme4)\nlibrary(car)\nlibrary(lme4)\nm_misto <- lmer(nplants ~ trat + (1 | exp/bloco), data = estande)\nsummary(m_misto)\nconfint(m_misto)\ncar::Anova(m_misto)\n\n```\n\n### **Representa√ß√£o visual de modelos ajustados**\n\nAqui usamos o `ggplot2` para representar visualmente o efeito de `trat` sobre `nplants`, comparando com diferentes linhas de tend√™ncia ajustadas nos modelos anteriores (com diferentes interceptos e inclina√ß√µes).\n\n```{r}\nlibrary(ggplot2)\n\nestande |>\n  ggplot(aes(trat, nplants, color = factor(exp))) +\n  geom_point() +\n  # geom_smooth(method = \"lm\", se = FALSE) +\n  geom_abline(intercept = 69.74, slope = -0.568, linewidth = 2) +\n  geom_abline(intercept = 43, slope = - 0.73, linetype = \"dashed\") +\n  geom_abline(intercept = 96, slope = - 0.40, linetype = \"dashed\")\n```\n\n## **An√°lise de Dose-Resposta (DRC) e c√°lculo de EC50**\n\nNesta se√ß√£o, utilizamos o pacote `drc` para ajustar modelos de regress√£o n√£o-linear do tipo log-log√≠stico, que s√£o ideais para dados de dose-resposta. Avaliamos o efeito da dose sobre a germina√ß√£o f√∫ngica, e estimamos a **dose efetiva 50% (EC50)** para o isolado FGT43.\n\nAjuste do modelo log-log√≠stico para um isolado espec√≠fico (FGT43)\n\n### **Estimativa de EC50 para m√∫ltiplos isolados com `ec50estimator`**\n\nNeste passo, usamos um pacote espec√≠fico para automatizar a estimativa de EC50 para todos os isolados presentes no conjunto de da\n\n```{r}\n\n# Importando os dados\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(drc)\n\n# Gr√°fico com os dados\nfungi <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nfungi |>\n  dplyr::group_by(code, dose) |>\n  summarise(germination = mean(germination), .groups = \"drop\") |>\n  ggplot(aes(dose, germination)) +\n  geom_point() +\n  facet_wrap(~ code)\n\n# Ajuste do modelo para FGT43\n\nFGT43 <- fungi |>\n  filter(code == \"FGT43\")\n\nm43 <- drm(germination ~ dose,\n           data = FGT43,\n           fct = LL.3())\n\nplot(m43)\nED(m43, 50)\n\nlibrary(\"ec50estimator\")\n\ndf_ec50 = estimate_EC50(germination ~dose,\n                        data = fungi,\n                        isolate_col = \"code\",\n                        strata_col = \"state\",\n                        interval = \"delta\",\n                        fct = drc:: LL.3())\ndf_ec50 |>\nggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  coord_flip()\n\ndf_ec50 |>\nggplot(aes(x = Estimate))+\n  geom_histogram(bins = 5, color = \"white\")\n\n\n```\n\nNeste exerc√≠cio, utilizaremos um conjunto de dados relacionados √† **ferrugem do cafeeiro (*Hemileia vastatrix*) na Eti√≥pia**. O objetivo √© demonstrar como importar, visualizar e representar espacialmente dados fitopatol√≥gicos com ferramentas modernas de R. A base foi obtida por meio de levantamento em fazendas cafeeiras, contendo registros de latitude, longitude e incid√™ncia da doen√ßa.\n\nUtilizamos a fun√ß√£o `gsheet2tbl()` do pacote **gsheet** para importar os dados diretamente da nuvem (Google Sheets). O objeto `cr` agora cont√©m as observa√ß√µes de incid√™ncia de ferrugem do caf√©, com coordenadas geogr√°ficas de coleta.\n\n```{r}\nlibrary(gsheet) \ncr <-  gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1871397229#gid=1871397229\")  \n```\n\nUsamos a fun√ß√£o `datatable()` do pacote **DT** para gerar uma tabela interativa, facilitando a visualiza√ß√£o e a explora√ß√£o dos dados. Essa visualiza√ß√£o √© √∫til para verificar rapidamente colunas como `lat`, `lon` e `inc`.\n\n```{r}\nlibrary(DT) \ndatatable(cr) \n```\n\nEssa √© uma visualiza√ß√£o b√°sica dos pontos geogr√°ficos de coleta. A fun√ß√£o `geom_point()` do **ggplot2** plota cada observa√ß√£o com base em sua longitude (`lon`) e latitude (`lat`).\n\nImportamos os limites administrativos da Eti√≥pia em formato espacial usando o pacote **rnaturalearthhires**. O resultado (`ETH`) √© um objeto `sf` que pode ser usado com `ggplot2`.\n\nEste gr√°fico mostra um mapa detalhado da Eti√≥pia com os pontos de coleta georreferenciados. A intensidade da cor representa a **incid√™ncia da ferrugem do cafeeiro**, permitindo identificar padr√µes geoespaciais da doen√ßa.\n\nSalva o mapa gerado no formato `.png`, com fundo branco e largura de 10 polegadas. Isso permite utilizar a imagem em apresenta√ß√µes, relat√≥rios ou publica√ß√µes.\n\n```{r}\n\nlibrary(tidyverse)\n\ncr |> \n  ggplot(aes(lon, lat))+\n  geom_point()\n\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\n\nremotes:: install_github(\"ropensci/rnaturalearthhires\")\n\nETH <- ne_states(country = \"Ethiopia\", returnclass = \"sf\")\n\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(ggspatial)\n\n\nETH |>\nggplot()+ \n  geom_sf(fill = \"gray80\") + \n  geom_point(data = cr, aes(lon, lat, color = inc))+\n  scale_color_viridis_c()+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  annotation_scale(location = \"tl\")+\n  annotation_north_arrow(location = \"br\", which_north = \"true\")+\n  labs(title = \"Ferrugem do caf√© na Eti√≥pia\", x = \"Longitude\", Y = \"Latiitude\", subtitle = \"Levantamento em fazendas\", caption = \"Fonte: Del Pnte et al. (2025)\", color = \"Incid√™ncia (%)\")\nggsave(\"mapa_etiopia.png\", bg = \"white\", width = 10)\n```\n","srcMarkdownNoYaml":"\n\nThis is a Quarto website.\n\nTo learn more about Quarto websites visit <https://quarto.org/docs/websites>.\n\n```{r}\n1 + 1\n```\n\n\"Este √© o caderno de aulas pr√°ticas da disciplina FIP-606 ‚Äì An√°lise e Visualiza√ß√£o de Dados em Fitopatologia. Ele serve como material de consulta futura, com c√≥digos para an√°lises estat√≠sticas, al√©m de disponibilizar publicamente as atividades executadas em sala de aula.\"\n\n# üìò **Aula 1 ‚Äî Importa√ß√£o, Manipula√ß√£o e Visualiza√ß√£o de Dados no R**\n\nVamos importar um conjunto de dados que est√° dispon√≠vel no R.\n\nNeste trecho, est√° sendo utilizado o dataset `Orange`, que j√° vem embutido no R. Ele cont√©m medidas de crescimento (circunfer√™ncia) de laranjeiras ao longo do tempo. A vari√°vel `dados` armazena esse conjunto para uso posterior.\n\n```{r}\ndados <- Orange\nOrange\n```\n\n**Transforma√ß√µes de dados**\n\nAqui √© feita a extra√ß√£o da vari√°vel `circumference`, e s√£o aplicadas transforma√ß√µes matem√°ticas comuns em an√°lise de dados:\n\n-   `exp(circ)` calcula o valor exponencial da circunfer√™ncia;\n\n-   `log(circ2)` retorna o logaritmo dos valores transformados.\\\n    Essas transforma√ß√µes s√£o √∫teis para explorar a distribui√ß√£o dos dados ou atender premissas de normalidade e homogeneidade de vari√¢ncia em an√°lises estat√≠sticas.\n\n```{r}\ncirc<-dados$circumference\ncirc2<-exp(circ)\ncirc2\ncirc3=log(circ2)\n```\n\n# Adi√ß√£o de uma variavel nova nos dados originais:\n\nNeste bloco, √© criada e adicionada ao dataframe original a nova vari√°vel `logcirc`, que representa o logaritmo da circunfer√™ncia. Isso facilita an√°lises futuras, como modelos lineares, que podem se beneficiar de vari√°veis transformadas.\n\n```{r}\ndados\ndados$logcirc<-log(dados$circumference)\ndados\n```\n\n# Desagregar um conjunto de dados em variaveis independentes:\n\nCom `attach()`, as vari√°veis do dataframe `dados` passam a estar dispon√≠veis diretamente no ambiente do R, sem a necessidade de usar `$`.\n\n```{r}\nattach(dados)\ncircumference\n```\n\n**Instala√ß√£o e uso de pacotes; c√°lculo de AUDPC**\n\nAqui s√£o carregados os pacotes `agricolae` (para an√°lises agr√≠colas) e `tidyverse` (conjunto de pacotes para ci√™ncia de dados). Em seguida, s√£o definidos vetores com dias e severidade da doen√ßa. A fun√ß√£o `audpc()` calcula a √Årea Abaixo da Curva de Progresso da Doen√ßa (AUDPC), uma m√©trica para quantificar a progress√£o temporal de doen√ßas em plantas.\n\n**Acessando dados do pacote agricolae**\n\nEste bloco carrega e inspeciona o dataset `corn`, tamb√©m do pacote `agricolae`. A fun√ß√£o `str()` √© usada para visualizar a estrutura do conjunto de dados, incluindo tipos de vari√°veis e primeiras observa√ß√µes ‚Äî etapa essencial na explora√ß√£o inicial dos dados.\n\n```{r}\nlibrary(agricolae)\nlibrary(tidyverse)\ndates <- c(14,21,28) # days\nseverity <- c(40,80,90)\nseverity\naudpc(severity,dates)\n\ndata(corn)\ncorn\nstr(corn)\n```\n\n### Criando gr√°ficos simples com `ggplot2`\n\nUm novo dataframe (`data_curva`) √© criado para representar a evolu√ß√£o da severidade ao longo do tempo. Em seguida, √© feito um gr√°fico combinando colunas (`geom_col`), linha (`geom_line`) e pontos (`geom_point`). Essa abordagem facilita a visualiza√ß√£o de tend√™ncias e flutua√ß√µes temporais de doen√ßas.\n\n```{r}\n\nlibrary(tidyverse)\ndates <- c(7,14,21,28,35,42) # days\nseverity <- c(0.1,5,10,35,50,60)\ndata_curva<-data.frame(dates,severity)\ndata_curva\n# meu primeiro plot\ndata_curva |>\n  mutate(severity2 = c(1,10,35,58,70,82)) |> \n  ggplot(aes(dates,severity2))+\n  geom_col()+\n  geom_line(linewidth = 2,color=\"blue\")+\n  geom_point(size = 5)+\n  theme_classic(base_size = 14)+\n  labs(x=\"Dia ap√≥s o plantio\",\n       y=\"severidade(%)\")+\n  scale_y_continuous(limits = c(0,100),n.breaks = 10)+\n  scale_x_continuous(n.breaks = 8)\n```\n\n### **Personalizando cores do gr√°fico**\n\nEste gr√°fico repete a visualiza√ß√£o anterior, mas com personaliza√ß√£o de **cores**: barras pretas, linha roxa e pontos pretos. Isso demonstra como `ggplot2` permite criar visualiza√ß√µes estilizadas para apresenta√ß√£o de resultados em artigos, relat√≥rios e slides.\n\n```{r}\ndata_curva |> \n  mutate(severity2 = c(1,10,35,58,70,82)) |> \n  ggplot(aes(dates, severity2)) +\n  geom_col(fill = \"BLACK\") +  # Barras em roxo\n  geom_line(linewidth = 2, color = \"PURPLE\") +  # Linha em roxo\n  geom_point(size = 5, color = \"black\") +  # Pontos em roxo\n  theme_classic(base_size = 14) +\n  labs(x = \"Dia ap√≥s o plantio\",\n       y = \"severidade(%)\") +\n  scale_y_continuous(limits = c(0, 100), n.breaks = 10) +\n  scale_x_continuous(n.breaks = 8)\n\n```\n\n# üìò **Aula 2 ‚Äî Leitura de Dados e Visualiza√ß√£o com `ggplot2`**\n\nO pacote `tidyverse` √© carregado para garantir acesso a fun√ß√µes essenciais para manipula√ß√£o de dados (`dplyr`, `readr`, `ggplot2`, etc.). Isso √© uma boa pr√°tica em qualquer an√°lise moderna no R.\n\n```{r}\nlibrary(tidyverse)\n```\n\n# Carregamento e leitura de arquivos Excel com `readxl`\n\nAqui o pacote `readxl` √© usado para importar uma planilha Excel (`.xlsx`) localizada localmente no computador. A aba (sheet) chamada `\"sensibilidade_fungicidas\"` √© lida e armazenada no objeto `dados`.\n\n```{r}\nlibrary(readxl)\nlibrary(tidyverse)\ndados <- read_excel(\"dados.xlsx\", sheet = \"sensibilidade_fungicidas\")\ndados \n\n```\n\n**Inspe√ß√£o da estrutura dos dados**\n\nAs fun√ß√µes `str()` e `glimpse()` ajudam a visualizar rapidamente as vari√°veis, tipos de dados e primeiras entradas. Isso √© crucial para entender como manipular ou transformar os dados corretamente.\n\n```{r}\nstr (dados)\n```\n\n```{r}\nglimpse(dados)\n```\n\n**Lendo diferentes abas do mesmo arquivo Excel**\n\nTesta-se a leitura de outras abas com nomes diferentes (`\"sensibilidade-fungicida\"` e `\"Planilha1\"`). Isso √© √∫til quando o mesmo arquivo cont√©m v√°rias tabelas experimentais.\n\n```{r}\ndados2 <- read_excel(\"dados.xlsx\",\n                  sheet = \"sensibilidade-fungicida\")\n```\n\n```{r}\nstr(dados2)\n```\n\n```{r}\nglimpse(dados2)\n```\n\n```{r}\ndados2 <- read_excel(\"dados.xlsx\",\n                  sheet = \"Planilha1\")\n\ndados2\n```\n\n# Importando dados do Google Sheets com `gsheet`\n\nCom o pacote `gsheet`, √© poss√≠vel importar dados diretamente do Google Sheets usando a fun√ß√£o `gsheet2tbl()`. Isso facilita o trabalho colaborativo e elimina a necessidade de downloads manuais.\n\n**Contagens e agrupamentos simples com `dplyr`**\n\nS√£o feitas contagens de observa√ß√µes agrupadas por `species`, `residue` e tamb√©m a combina√ß√£o entre `state` e `residue`. Essas an√°lises descritivas ajudam a entender a distribui√ß√£o dos dados.\n\n**Filtrando e combinando subconjuntos**\n\nAqui s√£o extra√≠das observa√ß√µes espec√≠ficas de dois estados (RS e PR) e unidas com `rbind()`. Isso permite compara√ß√µes regionais em an√°lises posteriores.\n\n**Selecionando colunas e criando subconjuntos anuais**\n\nS√£o criados subconjuntos contendo apenas informa√ß√µes relevantes e filtrados por ano, permitindo an√°lises temporais.\n\n**Selecionando colunas e criando subconjuntos anuais**\n\n`tabyl()` do pacote `janitor` produz tabelas cruzadas simples e organizadas, √∫teis para relat√≥rios e an√°lises explorat√≥rias.\n\n```{r}\n\nlibrary(gsheet)\ndados_nuvem <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\ndados_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\ndados_survey <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1118819738#gid=1118819738\")\n\nlibrary(dplyr)\ndados_survey |>\n  group_by(species) |>\n  count()\n\ndados_survey |>\n  group_by(residue) |>\n  count()\n\ndados_survey |>\n  group_by(state, residue) |>\n  count()\n\nRS <- dados_survey |>\n  filter(state== \"RS\")\n\nPR <- dados_survey |>\n  filter(state== \"PR\")\n\ncombinado <- rbind(RS, PR)\n\n\nsurvey_b <- dados_survey |>\n  dplyr:: select(year, state, species)\n\nsurvey_2009 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2009)\n\nsurvey_2010 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2010)\n\nsurvey_2011 <- dados_survey |>\n  dplyr:: select(year, state, species) |>\n  filter(year== 2011)\n\nlibrary(janitor)\nsurvey_b |>\n  tabyl(state, species)\n\nlibrary(janitor)\nsurvey_b |>\n  tabyl(species, year)\n\nlibrary(ggplot2)\n\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species))+\n  geom_col()+\n  scale_fill_manual(values=c(\"Purple\",\"yellow\"))\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species))+\n  geom_col()+\n  scale_fill_grey()\n\nsurvey_b |>\n  group_by(year, species) |>\n  count() |>\n  ggplot(aes(year, n, fill = species, color= species))+\n  geom_col()+\n  scale_fill_viridis_d()\n\n\n```\n\n**Gr√°ficos de barras com `ggplot2`**\n\nNeste gr√°fico de barras agrupadas, visualiza-se a frequ√™ncia de esp√©cies por ano. A paleta de cores √© personalizada. S√£o mostradas v√°rias varia√ß√µes desse gr√°fico:\n\n-   `scale_fill_manual()` ‚Äî cores definidas manualmente;\n\n-   `scale_fill_grey()` ‚Äî escala de cinza;\n\n-   `scale_fill_viridis_d()` ‚Äî cores perceptualmente uniformes, boas para dalt√¥nicos.\n\n**Boxplot com dados de magn√©sio**\n\nEste gr√°fico compara o efeito de diferentes tratamentos com magn√©sio sobre o comprimento da les√£o. O uso de `geom_jitter()` evita sobreposi√ß√£o dos pontos, melhorando a visualiza√ß√£o.\n\n```{r}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggplot2)\nlibrary(ggthemes)\nplot_magnesio <- mg |>\n  ggplot(aes(trat, comp))+\n  geom_boxplot(fill = \"white\",\n               outlier.colour = NA)+\n  geom_jitter(width = 0.1)+\n  scale_y_continuous(limits = c(0,20) )+\n  labs(x= \"Tratamento\",\n       y= \"Comprimento (mm)\",\n       title = \"Efeito do magn√©sio\",\n       subtitle = \"Tamanho da les√£o de mancha\",\n       caption = \"Fonte (SILVA, I. S. et al. 2025\")+\n  theme_clean()\nplot_magnesio\n```\n\n**Boxplot para taxa de crescimento micelial**\n\nOutro boxplot, agora para taxa de crescimento micelial por esp√©cie. As categorias s√£o reordenadas com `reorder()`, e o gr√°fico √© rotacionado (`coord_flip()`) para facilitar a leitura.\n\n```{r}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nlibrary(ggplot2)\nlibrary(ggthemes) # Para usar o tema theme_clean()\n\nplot_micelial <- micelial |> \n  ggplot(aes(x = reorder(especie, tcm), y = tcm)) +\n  geom_boxplot(fill = \"white\", outlier.colour = NA) +\n  geom_jitter(width = 0.1) +\n  coord_flip() +\n  labs(\n    x = \"Esp√©cie\",\n    y = \"TCM (mm)\",\n    title = \"Taxa de crescimento micelial\",\n    caption = \"Fonte: SILVA, I. S. et al. 2025\"\n  ) +\n  theme_clean()\nplot_micelial\n```\n\n**Combinando m√∫ltiplos gr√°ficos com `patchwork`**\n\nUtiliza-se o pacote `patchwork` para combinar os dois gr√°ficos anteriores lado a lado com anota√ß√µes (A, B, ...). O resultado √© salvo como imagem (`Combo1.png`), ideal para uso em relat√≥rios e artigos.\n\n```{r}\nlibrary(patchwork)\n(plot_magnesio|plot_micelial)+\n  plot_annotation(tag_levels = \"A\")\nggsave(\"Combo1.png\", bg = \"white\",\n       width = 8, height = 4)\n```\n\n# Aula 03 ‚Äî Testes estat√≠sticos (t, ANOVA, Kruskal), visualiza√ß√£o e checagem de pressupostos\n\n**Carregando e visualizando os dados do efeito do magn√©sio**\n\nNeste trecho, utilizamos pacotes essenciais (`gsheet`, `ggplot2` e `tidyr`) para importar dados diretamente de uma planilha do Google Sheets. Os dados cont√™m medi√ß√µes de comprimento de les√£o sob diferentes tratamentos. Em seguida, fazemos uma visualiza√ß√£o preliminar por meio de um gr√°fico de dispers√£o para comparar os tratamentos.\n\n### **Explorando os dados e realizando teste t para duas amostras independentes**\n\nAqui visualizamos as vari√°veis do objeto `dat_mg2`, convertemos o formato dos dados para wide, e comparamos os tratamentos \"control\" e \"Mg2\" por meio de um **teste t para amostras independentes**. Isso permite avaliar se h√° diferen√ßa significativa entre os dois grupos.\n\n### **Alternativa ao teste t com f√≥rmula e visualiza√ß√£o dos resultados**\n\nAgora utilizamos a f√≥rmula `comp ~ trat` dentro do teste t, com dados no formato longo. Tamb√©m utilizamos o pacote `ggpubr` para gerar um gr√°fico boxplot com anota√ß√£o do valor de **p**, facilitando a interpreta√ß√£o visual da compara√ß√£o estat√≠stica.\n\n### **Testes de normalidade e homogeneidade de vari√¢ncia**\n\nEsses testes s√£o premissas importantes para aplicar o teste t. O **teste de Shapiro-Wilk** avalia a normalidade dos dados, enquanto o **teste F de vari√¢ncias (var.test)** verifica a homogeneidade das vari√¢ncias entre os grupos.\n\n```{r}\n\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyr)\n\n\ndat_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\ndat_mg |> \n  ggplot2::ggplot(aes(trat, comp)) +\n  ggplot2::geom_jitter(width = 0.1)\n\nlibrary(dplyr)\n\ndat_mg2 <- dat_mg |> \n  pivot_wider(names_from = \"trat\", values_from = \"comp\") |>\n  dplyr:: select(-rep)\n\nnames(dat_mg2)\nglimpse(dat_mg2)\nhead(dat_mg2)\n\n\n\nattach(dat_mg2)\nt.test(control, Mg2,\n       var.equal = FALSE)\nt_results <- t.test(control, Mg2)\n\nlibrary(report)\nreport(t_results)\n\n\nlibrary(rstatix)\n\ntest <- t.test(comp ~ trat, data = dat_mg)\n\n # Instala o pacote\nlibrary(ggpubr)            # Carrega o pacote\n\n# Gr√°fico boxplot com ggboxplot\n\nlibrary(ggpubr)\n\nprint(test)\n\n# Crie o data frame com a compara√ß√£o e o valor de p\n\nlibrary(ggpubr)\n\nlibrary(ggpubr)\n\n# Crie o data frame com a compara√ß√£o e o valor de p\ntest <- data.frame(\n  group1 = \"control\",\n  group2 = \"Mg2\",\n  p.value = 2.423e-07,\n  y.position = 18\n)\n\np <- ggboxplot(dat_mg,\n               x = \"trat\",\n               y = \"comp\",\n               color = \"trat\",\n               palette = \"jco\")\np + stat_pvalue_manual(test, label = \"p.value\") +\n  ylim(0, 20)\n\n#Teste normalidade dos dados\n\nshapiro.test(dat_mg2$Mg2)\nshapiro.test(dat_mg2$control)\nhist(dat_mg2$Mg2, main = \"Histograma de Mg2\", xlab = \"Valores de comp\")\nhist(dat_mg2$control, main = \"Histograma de Controle\", xlab = \"Valores de comp\")\nvar.test(dat_mg2$Mg2, dat_mg2$control)\n\n# Homogenidade das variancias e normalidade sao as premissas do test T\n\n# Teste para saber se as variancias s√£o homogeneas - teste F\n\n# F = 1.4781, num df = 9, denom df = 9, p-value = 0.5698 - N√£o rejeita a hipotese nula, ent√£o as variancias sao homogeas \n\n# O test T ainda pode ser utilizado quando as variancias n√£o sao homogeas.\n\n\n```\n\n### **Teste t para amostras pareadas (dependentes)**\n\nEste conjunto de dados representa avalia√ß√µes feitas pelos mesmos avaliadores antes e depois de uma interven√ß√£o. Por isso, o teste t pareado √© apropriado. Utilizamos tamb√©m `pivot_wider` para estruturar os dados corretamente.\n\n### **Visualiza√ß√£o e testes de normalidade e vari√¢ncia (caso pareado)**\n\nAqui comparamos os grupos graficamente e testamos normalidade e homogeneidade das vari√¢ncias antes de aplicar os testes t e Wilcoxon (param√©trico e n√£o-param√©trico, respectivamente).\n\n```{r}\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(tidyr)\n\nescala  <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\n\n\nescala_wider <- escala %>%\n  pivot_wider(id_cols = rater, names_from = assessment, values_from = acuracia)\n\nnames(escala_wider)\n\nt.test(escala_wider$Unaided, escala_wider$Aided1,\n       paired = TRUE,\n       var.equal = FALSE)\n\nescala |>\n  ggplot(aes(x = assessment, y = acuracia)) +\n  geom_boxplot() +\n  labs(title = \"Compara√ß√£o da Acur√°cia por Assessment\",\n       x = \"Assessment\",\n       y = \"Acur√°cia\")\n\n\n# Filtrar e extrair a acur√°cia para os grupos\nunaided <- escala %>%\n  filter(assessment == \"Unaided\") %>%\n  dplyr:: select(acuracia) %>%\n  pull()\n\naided <- escala %>%\n  filter(assessment == \"Aided1\") %>% # Assumindo que o outro grupo √© \"Aided1\"\n  dplyr:: select(acuracia) %>%\n  pull()\n\n# Teste de compara√ß√£o de vari√¢ncias\nvar.test(unaided, aided)\n\n# Histogramas\nhist(unaided, main = NULL, xlab = NULL, ylab = NULL)\nhist(aided, main = NULL, xlab = NULL, ylab = NULL)\n\n# Testes de normalidade de Shapiro-Wilk\nshapiro.test(unaided)\nshapiro.test(aided)\n\n\n# Teste t N√ÉO pareado (Welch, assumindo vari√¢ncias possivelmente desiguais)\nt.test(unaided, aided, paired = FALSE, var.equal = FALSE)\n\n# Teste de Wilcoxon N√ÉO pareado\nwilcox.test(unaided, aided, paired = FALSE)\n```\n\n**ANOVA: compara√ß√£o entre mais de dois grupos**\n\nUsamos um conjunto de dados sobre o crescimento micelial para aplicar **ANOVA**, verificar pressupostos (normalidade e homogeneidade de vari√¢ncia), e seguir com compara√ß√µes m√∫ltiplas usando `emmeans`.\n\n```{r}\n\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(ggplot2) # \nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nmicelial %>%\n  ggplot(aes(x = especie, y = tcm)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1)\n\n    \nanova1 <- aov(tcm ~ especie, data = micelial)\nanova2 <- lm(tcm ~ especie, data = micelial)\n \nanova(anova1)\nanova(anova2)\nhist(residuals(anova1))\nshapiro.test(residuals(anova1))\n\n# Rejeita hipotese nula p- valor 2.028e-07.\n\n# Shapiro test =  p-value = 0.8782 n√£o rejeita.\n\nbartlett.test(tcm ~ especie, data = micelial)\nlibrary(rstatix)\nlevene_test(tcm ~ especie, data = micelial)\n\n\n# Para esse conjunto de dados, tem duas premissas legais.\n\nlibrary(emmeans)\n\nm = emmeans(anova2, ~ especie)\nm\n\nlibrary(multcomp)\ncld(m)\npairs(m) # Ao inves da matriz, faz uma tabela\npwpm(m) # Medias (comparando matriz)\n\n```\n\n### **Transforma√ß√µes, ANOVA e testes n√£o-param√©tricos**\n\nCom o conjunto `InsectSprays`, comparamos a efic√°cia de diferentes inseticidas por ANOVA. Aplicamos transforma√ß√µes para normalizar os dados e, alternativamente, usamos **Kruskal-Wallis**, que √© um teste n√£o-param√©trico para mais de dois grupos.\n\n```{r}\n# Novo conjundo de dados\n\nlibrary(ggplot2)\nlibrary(rstatix)\ninsetos = InsectSprays # Comparar insetiscidas diferentes\n\ninsetos |>\n  ggplot(aes(x = spray, y = count)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1)\nbartlett.test(count ~ spray, data = insetos)\n\nm2 <- lm(count ~ spray, data = insetos)\nhist(residuals(m2))\nshapiro_test(residuals(m2))\nqqnorm(residuals(m2))\nqqline(residuals(m2))\n\n## Alternativa 1 - transformar a resposta\n\n\nlibrary(rstatix) # Para shapiro_test\nlibrary(report)   # Para a fun√ß√£o report\n\nm3 <- lm(rank(count + 0.1) ~ spray, data = insetos)\nhist(residuals(m3), main = \"Histograma dos Res√≠duos\", xlab = \"Res√≠duos\")\nshapiro_test(residuals(m3))\nqqnorm(residuals(m3))\nqqline(residuals(m3))\nanova(m3)\n\n\nm33 <- emmeans(m3, ~ spray, type = \"response\")\ncld(m33)\nplot(m33)\n\n\n# Fazer o lm sem tranformar ***\n\n# Alternativa 2 - n√£o parametrico #\n\n# O teste n√£o-param√©trico equivalente √† ANOVA √© o Teste de Kruskal-Wallis.\n\nkruskal.test(count ~ spray, data = insetos)\nkruskal_test(insetos, count ~ spray)\n\nlibrary(agricolae)\nkruskal(insetos$count, insetos$spray, group = TRUE,\n        console = TRUE)\n```\n\n## **AULA 04 ‚Äì Diagn√≥stico de Res√≠duos com DHARMa**\n\n### **Objetivo:**\n\nAvaliar a qualidade do modelo ajustado `m3` utilizando o pacote **DHARMa**, que fornece diagn√≥sticos de res√≠duos simulados para modelos lineares e generalizados, testando pressupostos como normalidade e homocedasticidade.\n\n```{r}\n\nlibrary(DHARMa)\nm3\nplot(simulateResiduals(m3))\n\n\n\n\n```\n\n## **AULA 05 ‚Äì An√°lise de Experimentos com Blocos e Transforma√ß√µes**\n\n### **Importa√ß√£o e prepara√ß√£o dos dados de campo**\n\nNeste trecho, os dados experimentais de campo s√£o importados do Google Sheets e as vari√°veis categ√≥ricas s√£o corretamente convertidas em fatores. Tamb√©m convertemos a vari√°vel `FER` para num√©rica, garantindo que esteja no formato adequado para an√°lises.\n\n### **Visualiza√ß√£o explorat√≥ria da vari√°vel resposta**\n\nAntes de ajustar o modelo, √© fundamental visualizar a dispers√£o dos dados para cada tratamento e poss√≠veis tend√™ncias nos valores de `PROD` (produtividade).\n\n### **Ajuste de modelo linear com transforma√ß√£o logar√≠tmica**\n\nAqui, ajustamos um modelo linear para a vari√°vel `FER` (fermenta√ß√£o), transformada via logaritmo natural, considerando os efeitos fixos de bloco e tratamento.\n\n### **Verifica√ß√£o da signific√¢ncia via ANOVA**\n\nUtilizamos a ANOVA para avaliar a signific√¢ncia dos efeitos de tratamento e bloco sobre a vari√°vel resposta transformada.\n\n### **Diagn√≥stico de res√≠duos do modelo**\n\nAvaliamos os res√≠duos simulados do modelo com o pacote **DHARMa**, verificando poss√≠veis desvios das premissas de normalidade e homocedasticidade.\n\n### **Estimativas das m√©dias marginais (EMMeans)**\n\nCalculamos as m√©dias ajustadas para cada tratamento, as visualizamos e comparamos com letras de signific√¢ncia.\n\n### **Correla√ß√µes entre vari√°veis cont√≠nuas**\n\nCalculamos correla√ß√µes entre vari√°veis importantes do experimento (`FER`, `PROD`, `DFC`) para investigar rela√ß√µes lineares entre elas.\n\n```{r}\nlibrary(gsheet)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\n\n# Importando os dados\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Convertendo vari√°veis em fatores corretamente\ncampo <- campo |> \n  mutate(TRAT = factor(TRAT),\n         BLOCO = factor(BLOCO),\n         FER = as.numeric(FER)) # Convertendo FER para num√©rico caso esteja como texto\n\n# Visualizando os dados\nggplot(campo, aes(x = TRAT, y = PROD)) + \n  geom_jitter(width = 0.1) + \n  stat_summary(fun.data = \"mean_cl_boot\", colour = \"red\")\n\n# Ajustando o modelo correto\nm_campo <- lm(log(FER) ~ BLOCO + TRAT, data = campo)\n\n# Verificando ANOVA\nanova(m_campo)\n\n# Diagn√≥stico de res√≠duos\nplot(simulateResiduals(m_campo))\n\n# M√©dias marginais estimadas\nmeans_campo <- emmeans(m_campo, ~ TRAT, type = \"response\")\n\n# Plotando e analisando as m√©dias\nplot(means_campo)\nmeans_campo\nlibrary(agricolae)\ncv.model(m_campo)\ncld(means_campo)\npwpp(means_campo)\npwpm(means_campo) # Compara√ß√£o dos tratamentos numa matriz\n\ncor(campo$FER, campo$PROD)\ncor.test(campo$FER, campo$DFC)\n\ncampo |> \n  ggplot(aes(FER, DFC)) +\n  geom_point() +  # Corre√ß√£o aqui\n  geom_smooth(method = \"lm\")\n\n\n```\n\n## **Modelo Linear Misto ‚Äì An√°lise com Dados de Milho**\n\n### **Importa√ß√£o e visualiza√ß√£o dos dados**\n\nImportamos outro conjunto de dados com experimentos em milho e visualizamos os efeitos dos h√≠bridos e m√©todos sobre o √≠ndice.\n\n### **Prepara√ß√£o dos dados e ajuste de modelo misto**\n\nCriamos uma vari√°vel de intera√ß√£o entre h√≠brido e bloco, e ajustamos um modelo linear misto com efeito aleat√≥rio de `hybrid_block`.\n\n### **ANOVA e diagn√≥stico do modelo misto**\n\nUtilizamos a fun√ß√£o `Anova()` para verificar a signific√¢ncia dos efeitos fixos e `DHARMa` para verificar res√≠duos simulados.\n\n### **Ajuste de novo modelo para produtividade**\n\nAjustamos um segundo modelo considerando a vari√°vel resposta `yield`, incorporando estrutura hier√°rquica com blocos aninhados em h√≠brido.\n\n### **Ajuste de novo modelo para produtividade**\n\nAjustamos um segundo modelo considerando a vari√°vel resposta `yield`, incorporando estrutura hier√°rquica com blocos aninhados em h√≠brido.\n\n### **Rela√ß√£o entre √≠ndice e produtividade**\n\nExploramos a correla√ß√£o entre `index` e `yield`, tanto visualmente quanto numericamente, calculando o coeficiente de determina√ß√£o (R¬≤).\n\n```{r}\n\nlibrary(gsheet)\nlibrary(lme4)\nlibrary(car)\nlibrary(DHARMa)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(multcomp)\nlibrary(emmeans)\n\n# Importando os dados\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualiza√ß√£o dos dados\nmilho |> \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n\n# Criando a intera√ß√£o de h√≠brido e bloco\nmilho <- milho |> mutate(hybrid_block = interaction(hybrid, block))\n\n# Ajuste do modelo linear misto\nm_milho <- lmer(index ~ hybrid * method + (1 | hybrid_block), data = milho)\n\n# ANOVA\nAnova(m_milho)\n\n# Diagn√≥stico de res√≠duos\nplot(simulateResiduals(m_milho))\n\nm_milho2 <- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho2)\nplot(simulateResiduals(m_milho2))\n\nmedia_milho2 <- emmeans(m_milho2, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n\n# Corre√ß√£o do erro de digita√ß√£o: \"indez\" para \"index\"\nmilho |> \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n\ncor1 <- cor(milho$index, milho$yield)\ncor1^2 * 100\ncor.test(milho$index, milho$yield)\n\n\n\n```\n\n# AULA 06 ‚Äì Transforma√ß√µes Box-Cox, Regress√£o e Modelos Mistos\n\n### **Transforma√ß√£o Box-Cox em dados com problemas de normalidade**\n\nA transforma√ß√£o de Box-Cox √© √∫til quando os dados n√£o atendem aos pressupostos de normalidade e homocedasticidade. O m√©todo busca encontrar uma pot√™ncia (lambda) ideal para transformar a vari√°vel resposta e melhorar o ajuste do modelo linear. Aqui, usamos dados do conjunto `InsectSprays` e aplicamos a transforma√ß√£o em `count`.\n\n```{r}\n\nlibrary(MASS)\nlibrary(DHARMa)\nlibrary(tidyverse)\nlibrary(agricolae)\n\ninsects <- InsectSprays\nm1 <- lm(sqrt(count) ~ spray, data = insects)\nplot(m1)\n\nb <- boxcox(lm(count + 0.1 ~ 1, data = insects))\nlambda <- b$x[which.max(b$y)]\nlambda\n\ninsects <- insects |>\n  mutate(count2 = (count^lambda - 1) / lambda,\n         count3 = sqrt(count))\n\nhist(insects$count)\n\nm1 <- lm(count2 ~ spray, data = insects)\nplot(m1)\n\n# Usar quando as premissas dos dados usando log e raiz quadrada nao est√£o ok\n\n\n\n\n```\n\n> **Nota:** A transforma√ß√£o Box-Cox √© especialmente √∫til quando transforma√ß√µes usuais como log ou raiz quadrada n√£o resolvem os problemas dos res√≠duos do modelo.\n\n### **An√°lise de regress√£o simples por experimento**\n\nNesta se√ß√£o, usamos dados experimentais sobre a porcentagem de in√≥culo e o n√∫mero de plantas infectadas. Inicialmente, visualizamos os dados e depois realizamos uma regress√£o linear simples para cada experimento individualmente (exp1, exp2 e exp3).\n\n```{r}\n# Importando os dados\n\nlibrary(gsheet)\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555\")\n\n# Ser√° que tem efeito a concentra√ß√£o de inoculo no n√∫mero de plantas infectadas?\n\n\nlibrary(ggplot2)\n\nestande |>\nggplot(aes(x = trat, y = nplants)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",  se = FALSE,\n              color = \"black\")+\n  facet_wrap( ~exp)+\n  theme_minimal()+\n  labs(x = \" % de inoculo na semente\",\n       y = \"N√∫mero de Plantas\")\n```\n\n# Regress√µes individuais por experimento\n\n```{r}\nexp1 <- estande |>\n  filter(exp == 1)\n\nm_exp1 <- lm(nplants ~ trat, data = exp1)\nsummary(m_exp1)\n\nexp1 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n    ylim(20,60)\n\nexp2 <- estande |>\n  filter(exp == 2)\n\nm_exp2 <- lm(nplants ~ trat, data = exp2)\nsummary(m_exp2)\n\nexp3 <- estande |>\n  filter(exp == 3)\n\nm_exp3 <- lm(nplants ~ trat, data = exp3)\nsummary(m_exp3)\n```\n\n### **Modelo linear misto para considerar estrutura hier√°rquica**\n\nCom dados oriundos de m√∫ltiplos experimentos com blocos, um **modelo misto** √© mais apropriado para considerar a varia√ß√£o entre blocos dentro de cada experimento. Isso permite generalizar os resultados sem ignorar fontes de varia√ß√£o.\n\n```{r}\nlibrary(lme4)\nlibrary(car)\nlibrary(lme4)\nm_misto <- lmer(nplants ~ trat + (1 | exp/bloco), data = estande)\nsummary(m_misto)\nconfint(m_misto)\ncar::Anova(m_misto)\n\n```\n\n### **Representa√ß√£o visual de modelos ajustados**\n\nAqui usamos o `ggplot2` para representar visualmente o efeito de `trat` sobre `nplants`, comparando com diferentes linhas de tend√™ncia ajustadas nos modelos anteriores (com diferentes interceptos e inclina√ß√µes).\n\n```{r}\nlibrary(ggplot2)\n\nestande |>\n  ggplot(aes(trat, nplants, color = factor(exp))) +\n  geom_point() +\n  # geom_smooth(method = \"lm\", se = FALSE) +\n  geom_abline(intercept = 69.74, slope = -0.568, linewidth = 2) +\n  geom_abline(intercept = 43, slope = - 0.73, linetype = \"dashed\") +\n  geom_abline(intercept = 96, slope = - 0.40, linetype = \"dashed\")\n```\n\n## **An√°lise de Dose-Resposta (DRC) e c√°lculo de EC50**\n\nNesta se√ß√£o, utilizamos o pacote `drc` para ajustar modelos de regress√£o n√£o-linear do tipo log-log√≠stico, que s√£o ideais para dados de dose-resposta. Avaliamos o efeito da dose sobre a germina√ß√£o f√∫ngica, e estimamos a **dose efetiva 50% (EC50)** para o isolado FGT43.\n\nAjuste do modelo log-log√≠stico para um isolado espec√≠fico (FGT43)\n\n### **Estimativa de EC50 para m√∫ltiplos isolados com `ec50estimator`**\n\nNeste passo, usamos um pacote espec√≠fico para automatizar a estimativa de EC50 para todos os isolados presentes no conjunto de da\n\n```{r}\n\n# Importando os dados\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(drc)\n\n# Gr√°fico com os dados\nfungi <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nfungi |>\n  dplyr::group_by(code, dose) |>\n  summarise(germination = mean(germination), .groups = \"drop\") |>\n  ggplot(aes(dose, germination)) +\n  geom_point() +\n  facet_wrap(~ code)\n\n# Ajuste do modelo para FGT43\n\nFGT43 <- fungi |>\n  filter(code == \"FGT43\")\n\nm43 <- drm(germination ~ dose,\n           data = FGT43,\n           fct = LL.3())\n\nplot(m43)\nED(m43, 50)\n\nlibrary(\"ec50estimator\")\n\ndf_ec50 = estimate_EC50(germination ~dose,\n                        data = fungi,\n                        isolate_col = \"code\",\n                        strata_col = \"state\",\n                        interval = \"delta\",\n                        fct = drc:: LL.3())\ndf_ec50 |>\nggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  coord_flip()\n\ndf_ec50 |>\nggplot(aes(x = Estimate))+\n  geom_histogram(bins = 5, color = \"white\")\n\n\n```\n\nNeste exerc√≠cio, utilizaremos um conjunto de dados relacionados √† **ferrugem do cafeeiro (*Hemileia vastatrix*) na Eti√≥pia**. O objetivo √© demonstrar como importar, visualizar e representar espacialmente dados fitopatol√≥gicos com ferramentas modernas de R. A base foi obtida por meio de levantamento em fazendas cafeeiras, contendo registros de latitude, longitude e incid√™ncia da doen√ßa.\n\nUtilizamos a fun√ß√£o `gsheet2tbl()` do pacote **gsheet** para importar os dados diretamente da nuvem (Google Sheets). O objeto `cr` agora cont√©m as observa√ß√µes de incid√™ncia de ferrugem do caf√©, com coordenadas geogr√°ficas de coleta.\n\n```{r}\nlibrary(gsheet) \ncr <-  gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1871397229#gid=1871397229\")  \n```\n\nUsamos a fun√ß√£o `datatable()` do pacote **DT** para gerar uma tabela interativa, facilitando a visualiza√ß√£o e a explora√ß√£o dos dados. Essa visualiza√ß√£o √© √∫til para verificar rapidamente colunas como `lat`, `lon` e `inc`.\n\n```{r}\nlibrary(DT) \ndatatable(cr) \n```\n\nEssa √© uma visualiza√ß√£o b√°sica dos pontos geogr√°ficos de coleta. A fun√ß√£o `geom_point()` do **ggplot2** plota cada observa√ß√£o com base em sua longitude (`lon`) e latitude (`lat`).\n\nImportamos os limites administrativos da Eti√≥pia em formato espacial usando o pacote **rnaturalearthhires**. O resultado (`ETH`) √© um objeto `sf` que pode ser usado com `ggplot2`.\n\nEste gr√°fico mostra um mapa detalhado da Eti√≥pia com os pontos de coleta georreferenciados. A intensidade da cor representa a **incid√™ncia da ferrugem do cafeeiro**, permitindo identificar padr√µes geoespaciais da doen√ßa.\n\nSalva o mapa gerado no formato `.png`, com fundo branco e largura de 10 polegadas. Isso permite utilizar a imagem em apresenta√ß√µes, relat√≥rios ou publica√ß√µes.\n\n```{r}\n\nlibrary(tidyverse)\n\ncr |> \n  ggplot(aes(lon, lat))+\n  geom_point()\n\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\n\nremotes:: install_github(\"ropensci/rnaturalearthhires\")\n\nETH <- ne_states(country = \"Ethiopia\", returnclass = \"sf\")\n\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(ggspatial)\n\n\nETH |>\nggplot()+ \n  geom_sf(fill = \"gray80\") + \n  geom_point(data = cr, aes(lon, lat, color = inc))+\n  scale_color_viridis_c()+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  annotation_scale(location = \"tl\")+\n  annotation_north_arrow(location = \"br\", which_north = \"true\")+\n  labs(title = \"Ferrugem do caf√© na Eti√≥pia\", x = \"Longitude\", Y = \"Latiitude\", subtitle = \"Levantamento em fazendas\", caption = \"Fonte: Del Pnte et al. (2025)\", color = \"Incid√™ncia (%)\")\nggsave(\"mapa_etiopia.png\", bg = \"white\", width = 10)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"cosmo","title":"Fip_caderno"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}